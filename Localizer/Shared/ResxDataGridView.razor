@using System.Collections.ObjectModel;

@if (Tree is not null && entriesLoaded)
{
    <MudPaper Style="min-width:1000px;width:100vw" Height="90vh">
        <MudDataGrid Items="@Entries" Virtualize="true" FixedHeader="true" Height="89vh" HorizontalScrollbar="true"
            Style="min-width:100vw" Striped="true" Dense="true">
            <Columns>
                <TemplateColumn Title="Key" Sortable="true" CellStyle="min-width:400px">
                    <CellTemplate>
                        <MudText Typo="Typo.h6">@context.Item.Key</MudText>
                    </CellTemplate>
                </TemplateColumn>
                @* <PropertyColumn Property="x => x.Column1" Title="Key" CellStyle="min-width:300px" /> *@
                @foreach (var culture in Tree.Cultures)
                {
                    <TemplateColumn Title="@(culture==string.Empty?"Neutral":culture)" Sortable="true"
                        CellStyle="min-width:400px">
                        <CellTemplate>
                            <MudText Typo="Typo.h6">@context.Item.GetValue(culture)</MudText>
                        </CellTemplate>
                    </TemplateColumn>
                }
            </Columns>
        </MudDataGrid>
    </MudPaper>
}
@code {

    [Parameter]
    public ResxLoadDataTree Tree { get; set; }

    public bool entriesLoaded = false;

    public ObservableCollection<ResxEntity> Entries;

    protected override async void OnParametersSet()
    {
        base.OnParametersSet();

        if (Tree is null)
            return;

        var manager = await Tree.LoadAllEntities();

        Entries = manager.ResxEntities;

        entriesLoaded = true;

        StateHasChanged();
    }

    protected override void OnInitialized()
    {

    }
}